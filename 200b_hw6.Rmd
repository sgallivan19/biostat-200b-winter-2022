---
title: "200b_homework6"
author: "Seamus Gallivan"
date: "2/20/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Read in senic data

```{r}
library(olsrr)
library(car)
library(MASS)
library(tidyverse)
senic <- read_csv("/Users/seamusgallivan/Documents/ucla/200B/data/senic.csv")
```

## Question 2 

Model regressing loglength on xray, census and age

```{r}
#create log transformed length 
senic <- senic %>% 
  mutate(loglength = log(length))
#model 
model1 <- lm(loglength ~ xray + census + age, data = senic)
summary(model1)
```

**Part A**

Leverage, studentized residuals and Cook's D plots

```{r}
#leverage plots
leveragePlots(model1)
#studentized residual 
stud_resids <- as_tibble(studres(model1))
#create row index column in stud_resids to help with join 
stud_resids$index <- seq.int(nrow(stud_resids))
#left join 
senic <- senic %>% 
  left_join(stud_resids, by = c("id" = "index"))
#rename value to studres 
senic <- rename(senic, sres_value = value)
#sres plot 
sres <- ggplot(senic, aes(id, sres_value))
sres + geom_point()
#Cook's D
ols_plot_cooksd_bar(model1)
```

**Part B**

```{r}
fivenum(senic$loglength)
fivenum(senic$xray)
fivenum(senic$census)
fivenum(senic$age)
```

Hospitals 47 and 112 have the highest Cook's D values.
Based on the plots, they have large leverage values and studentized residual values of 2 or greater. In comparison to their five number (min, 25th percentile, median, 75th percentile, max) summary, they have above 75th percentile log(length) values, above 50th percentile xray values, above 75th percentile census values and above 75th percentile age values. 
